total_rev = sum(price),
.groups = "drop"
) %>%
mutate(
z_score = round(scale(total_rev), 2)
) %>%
filter(z_score == 0)
View(b)
df %>%
select(origin, destination, carrier, flight_number, departure_date, departure_time, price) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
.groups = "drop"
) %>%
mutate(
z_score = round(scale(total_rev), 2)
) %>%
filter(z_score == 0) %>%
head(5) %>%
kable()
rm(a,b)
a = df %>%
select(market, price) %>%
group_by(market) %>%
summarise(
price_mean = sum(price),
.groups = "drop"
)
View(a)
a = df %>%
select(market, price) %>%
group_by(market) %>%
summarise(
price_sum = sum(price),
price_mean = mean(price),
.groups = "drop"
)
table(df$market)
df %>%
select(market, price) %>%
group_by(market) %>%
summarise(
price_mean = mean(price),
.groups = "drop"
) %>%
mutate(
price_zscore = scale(price_mean)
) %>%
kable()
df %>%
select(market, price) %>%
group_by(market)
t1 = df %>%
select(origin, destination, carrier, flight_number, departure_date, departure_time, price) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
.groups = "drop"
) %>%
mutate(
z_score = round(scale(total_rev), 2)
)
View(t1)
View(t1)
t2 = df %>%
select(origin, destination, carrier, flight_number, departure_date, departure_time, price) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
.groups = "drop"
)
View(t2)
t2 = df %>%
select(origin, destination, market, carrier, flight_number, departure_date, departure_time, price) %>%
group_by(origin, destination, market, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
.groups = "drop"
)
t2 = df %>%
select(origin, destination, market, carrier, flight_number, departure_date, departure_time, price) %>%
group_by(origin, destination, market, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
.groups = "drop"
) %>%
group_by(market) %>%
summarise(
asdf = sum(total_rev)
)
t2 = df %>%
select(origin, destination, market, carrier, flight_number, departure_date, departure_time, price) %>%
group_by(origin, destination, market, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
.groups = "drop"
) %>%
group_by(market) %>%
summarise(
asdf = sum(total_rev)/n()
)
t2 = df %>%
select(origin, destination, market, carrier, flight_number, departure_date, departure_time, price) %>%
group_by(origin, destination, market, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
.groups = "drop"
) %>%
group_by(market) %>%
summarise(
avg_revenue = sum(total_rev)/n()
)
t3 = df %>%
select(market, price) %>%
group_by(market) %>%
summarise(
total_rev = sum(price)/n(),
.groups = "drop"
)
View(t3)
t2 = df %>%
select(origin, destination, market, carrier, flight_number, departure_date, departure_time, price) %>%
group_by(origin, destination, market, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
.groups = "drop"
) %>%
group_by(market) %>%
summarise(
avg_revenue = sum(total_rev)/n(),
z_score = scale(avg_revenue)
)
t2 = df %>%
select(origin, destination, market, carrier, flight_number, departure_date, departure_time, price) %>%
group_by(origin, destination, market, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
.groups = "drop"
) %>%
group_by(market) %>%
summarise(
avg_revenue = sum(total_rev)/n(),
z_score = scale(avg_revenue),
.groups = "drop"
)
t2 = df %>%
select(origin, destination, market, carrier, flight_number, departure_date, departure_time, price) %>%
group_by(origin, destination, market, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
.groups = "drop"
) %>%
group_by(market) %>%
summarise(
avg_revenue = sum(total_rev)/n(),
.groups = "drop"
) %>%
mutate(
z_score = scale(avg_revenue)
)
t2 = df %>%
select(origin, destination, market, carrier, flight_number, departure_date, departure_time, price) %>%
group_by(origin, destination, market, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
.groups = "drop"
) %>%
group_by(market) %>%
summarise(
avg_revenue = sum(total_rev)/n(),
.groups = "drop"
) %>%
mutate(
z_score = scale(avg_revenue)
) %>%
arrange(desc(z_score))
knitr::opts_chunk$set(echo = TRUE)
# load libraries
library(tidyverse)
library(ggplot2)
library(lubridate)
library(knitr)
# load data
df <- read.csv("C:/Users/abhis/Desktop/airfares.csv/airfares.csv")
# recast
df$origin = as.factor(df$origin)
df$destination = as.factor(df$destination)
df$carrier = as.factor(df$carrier)
df$flight_number = as.factor(df$flight_number)
df$fare_basis = as.factor(df$fare_basis)
df$market = as.factor(df$market)
df$observation_date = ymd(df$observation_date)
df$departure_date = ymd(df$departure_date)
a = df %>%
select(observation_date, departure_date, price) %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
)
View(a)
hist(a$price)
hist(a$days_before_dept)
cor(a$price, a$days_before_dept)
b = df %>%
select(origin, destination, market, carrier, flight_number, departure_date, departure_time, price) %>%
group_by(origin, destination, market, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
.groups = "drop"
)
View(b)
a = df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = mean(days_before_dept)
.groups = "drop"
a = df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = mean(days_before_dept),
.groups = "drop"
)
a = df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = mean(days_before_dept),
.groups = "drop"
)
View(a)
a = df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = roun(mean(days_before_dept),0),
.groups = "drop"
)
a = df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = round(mean(days_before_dept),0),
.groups = "drop"
)
a = df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = round(mean(days_before_dept),0),
.groups = "drop"
) %>%
mutate(
z_score = round(scale(total_rev), 2)
)
plot(a$avg_days_before_dept, a$z_score)
cor(a$avg_days_before_dept, a$z_score)
df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = round(mean(days_before_dept),0),
.groups = "drop"
) %>%
mutate(
z_score = round(scale(total_rev), 2)
) %>%
ggplot(aes(x = avg_days_before_dept, y = z_score)) +
geom_point() +
geom_smooth()
?geom_smooth
df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = round(mean(days_before_dept),0),
.groups = "drop"
) %>%
mutate(
z_score = round(scale(total_rev), 2)
) %>%
ggplot(aes(x = avg_days_before_dept, y = z_score)) +
geom_point() +
geom_smooth(method = "lm")
df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = round(mean(days_before_dept),0),
.groups = "drop"
) %>%
mutate(
z_score = round(scale(total_rev), 2)
) %>%
ggplot(aes(x = avg_days_before_dept, y = z_score)) +
geom_point(color = "lightblue") +
geom_smooth(method = "lm", color = "red")
df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = round(mean(days_before_dept),0),
.groups = "drop"
) %>%
mutate(
z_score = round(scale(total_rev), 2)
) %>%
ggplot(aes(x = avg_days_before_dept, y = z_score)) +
geom_point(color = "lightblue") +
geom_smooth(method = "lm", color = "red")
df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = round(mean(days_before_dept),0),
.groups = "drop"
) %>%
mutate(
z_score = round(scale(total_rev), 2)
) %>%
ggplot(aes(x = avg_days_before_dept, y = z_score)) +
geom_point(color = "blue", alpha = 0.7) +
geom_smooth(method = "lm", color = "red")
df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = round(mean(days_before_dept),0),
.groups = "drop"
) %>%
mutate(
z_score = round(scale(total_rev), 2)
) %>%
ggplot(aes(x = avg_days_before_dept, y = z_score)) +
geom_point(color = "blue", alpha = 0.5) +
geom_smooth(method = "lm", color = "red")
df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = round(mean(days_before_dept),0),
.groups = "drop"
) %>%
mutate(
z_score = round(scale(total_rev), 2)
) %>%
ggplot(aes(x = avg_days_before_dept, y = z_score)) +
geom_point(color = "blue", alpha = 0.3) +
geom_smooth(method = "lm", color = "red")
df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = round(mean(days_before_dept),0),
.groups = "drop"
) %>%
mutate(
z_score = round(scale(total_rev), 2)
) %>%
ggplot(aes(x = avg_days_before_dept, y = z_score)) +
geom_point(color = "blue", alpha = 0.15) +
geom_smooth(method = "lm", color = "red")
df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = round(mean(days_before_dept),0),
.groups = "drop"
) %>%
mutate(
z_score = round(scale(total_rev), 2)
) %>%
ggplot(aes(x = avg_days_before_dept, y = z_score)) +
geom_point(color = "blue", alpha = 0.12) +
geom_smooth(method = "lm", color = "red")
df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = round(mean(days_before_dept),0),
.groups = "drop"
) %>%
mutate(
z_score = round(scale(total_rev), 2)
) %>%
ggplot(aes(x = avg_days_before_dept, y = z_score)) +
geom_point(color = "blue", alpha = 0.12) +
geom_smooth(method = "lm", color = "red") +
xlab("average days before flight (for a single flight)") +
ylab("z-score for flight")
knitr::opts_chunk$set(echo = TRUE)
# load libraries
library(tidyverse)
library(ggplot2)
library(lubridate)
library(knitr)
# load data
df <- read.csv("C:/Users/abhis/Desktop/airfares.csv/airfares.csv")
# recast
df$origin = as.factor(df$origin)
df$destination = as.factor(df$destination)
df$carrier = as.factor(df$carrier)
df$flight_number = as.factor(df$flight_number)
df$fare_basis = as.factor(df$fare_basis)
df$market = as.factor(df$market)
df$observation_date = ymd(df$observation_date)
df$departure_date = ymd(df$departure_date)
df %>%
mutate(
days_before_dept = as.numeric(departure_date - observation_date)
) %>%
group_by(origin, destination, carrier, flight_number, departure_date, departure_time) %>%
summarise(
total_rev = sum(price),
avg_days_before_dept = round(mean(days_before_dept),0),
.groups = "drop"
) %>%
mutate(
z_score = round(scale(total_rev), 2)
) %>%
ggplot(aes(x = avg_days_before_dept, y = z_score)) +
geom_point(color = "blue", alpha = 0.12) +
geom_smooth(method = "lm", color = "red") +
xlab("average days before flight (per flight)") +
ylab("z-score for flight")
imdb = pd.read_csv('C:/Users/abhis/Documents/Duke University/IDS 793 Unifying Data Science/unifying-data-science-2021-project-team_9/00_data/imdb_movies.csv')
imdb = read.csv('C:/Users/abhis/Documents/Duke University/IDS 793 Unifying Data Science/unifying-data-science-2021-project-team_9/00_data/imdb_movies.csv')
mojo = read.csv('C:/Users/abhis/Documents/Duke University/IDS 793 Unifying Data Science/unifying-data-science-2021-project-team_9/00_data/mojo_movies.csv')
actor = read.csv('C:/Users/abhis/Documents/Duke University/IDS 793 Unifying Data Science/unifying-data-science-2021-project-team_9/00_data/all_poc_actor_actress.csv',
encoding='latin-1')
library(tidyverse)
View(imdb)
View(mojo)
movies = left_join(imdb, mojo, by = "titles")
View(movies)
imdb = read.csv('C:/Users/abhis/Documents/Duke University/IDS 793 Unifying Data Science/unifying-data-science-2021-project-team_9/00_data/imdb_movies.csv')
mojo = read.csv('C:/Users/abhis/Documents/Duke University/IDS 793 Unifying Data Science/unifying-data-science-2021-project-team_9/00_data/mojo_movies.csv')
actor = read.csv('C:/Users/abhis/Documents/Duke University/IDS 793 Unifying Data Science/unifying-data-science-2021-project-team_9/00_data/all_poc_actor_actress.csv',
encoding='latin-1')
View(imdb)
as.numeric(gsub("([0-9]+).*$", "\\1",imdb$year))
as.numeric(gsub("([0-9]+).*$", "\\1","|| 2017"))
library(tidyr)
extract_numeric(imdb$year)
imdb$year = extract_numeric(imdb$year)
imdb$year = substr(imdb$year, start = 1, stop = 4)
imdb = unique(imdb)
View(imdb)
movies = left_join(imdb, mojo, by = "titles")
?left_join
View(actor)
movies = left_join(movies, actor, by = c("lead_actor" = "Name"))
View(movies)
movies$Race = ifelse(is.na(movies$Race) == T, "Not POC", movies$Race)
movies$Race_Specific = ifelse(is.na(movies$Race) == T, "White", movies$Race_Specific)
View(imdb)
View(movies)
movies$Race_Specific = ifelse(is.na(movies$Race) == T, "White", movies$Race_Specific)
movies$Race_Specific = ifelse(is.na(movies$Race_Specific) == T, "White", movies$Race_Specific)
pwd
setwd("~/Duke University/IDS 793 Unifying Data Science/unifying-data-science-2021-project-team_9/00_data")
write.csv(movies, file = "full_data.csv", row.names = F)
git add .
